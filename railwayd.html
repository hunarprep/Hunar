<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Railway Group D</title>
    
    <script src="railwaydquestions.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            /* RAILWAY THEME COLOR (Red) */
            --primary: #dc2626;
            --primary-light: #fef2f2;
            --text-dark: #0f172a;
            --white: #ffffff;
        }

        body { font-family: 'Segoe UI', sans-serif; background: #f1f5f9; margin: 0; display: flex; justify-content: center; min-height: 100vh; }
        .app-container { width: 100%; max-width: 480px; background: white; min-height: 100vh; box-shadow: 0 0 20px rgba(0,0,0,0.1); display: flex; flex-direction: column; }

        /* HEADER */
        .header {
            background: var(--primary);
            color: var(--white);
            padding: 25px 20px;
            border-bottom-left-radius: 24px;
            border-bottom-right-radius: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .header a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px; /* Prevents overlap */
            display: inline-block;
            width: fit-content;
        }

        .header h1 { margin: 0; font-size: 26px; font-weight: 700; }
        .header p { margin: 5px 0 0; opacity: 0.9; font-size: 14px; }

        /* SCREENS */
        .screen { display: none; padding: 20px; flex-grow: 1; animation: fadeIn 0.3s ease-in-out; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS */
        .menu-card {
            background: white; border: 1px solid #e2e8f0; border-radius: 16px; padding: 20px; margin-bottom: 15px;
            display: flex; align-items: center; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .menu-card:active { transform: scale(0.98); background: var(--primary-light); border-color: var(--primary); }

        /* QUIZ BUTTONS */
        .opt-btn {
            width: 100%; padding: 16px; margin-bottom: 12px; border: 2px solid #e2e8f0; background: white;
            border-radius: 12px; font-size: 16px; text-align: left; color: var(--text-dark); cursor: pointer;
        }
        .opt-btn.correct { background: #dcfce7; border-color: #22c55e; color: #14532d; }
        .opt-btn.wrong { background: #fee2e2; border-color: #ef4444; color: #7f1d1d; }

        /* RESULTS */
        .result-box { text-align: center; padding: 40px 20px; }
        .score-circle {
            width: 120px; height: 120px; background: var(--primary); color: white; border-radius: 50%;
            display: flex; justify-content: center; align-items: center; font-size: 32px; font-weight: bold; margin: 0 auto 20px;
        }
        .action-btn {
            background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 12px;
            font-size: 16px; font-weight: 600; cursor: pointer; width: 100%; margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="app-container">
    
    <div class="header">
        <a href="index.html" id="lbl-home">‚Üê Home</a>
        <h1 id="lbl-title">Railway Group D</h1>
        <p>Science, Math & GK</p>
    </div>

    <div id="screen-modes" class="screen active">
        <h3 id="lbl-select" style="color:#64748b; margin-bottom:20px;">Select Mode:</h3>

        <div class="menu-card" onclick="startPractice()">
            <span style="font-size:24px; margin-right:15px;">üìù</span>
            <div>
                <strong id="lbl-prac">Practice Quiz</strong><br>
                <span id="lbl-prac-sub" style="font-size:12px; color:#64748b;">5 Random Questions</span>
            </div>
        </div>

        <div class="menu-card" onclick="startExam()">
            <span style="font-size:24px; margin-right:15px;">‚è±Ô∏è</span>
            <div>
                <strong id="lbl-test">Test Mode</strong><br>
                <span id="lbl-test-sub" style="font-size:12px; color:#64748b;">100 Questions ‚Ä¢ 90 Mins</span>
            </div>
        </div>
    </div>

    <div id="screen-quiz" class="screen">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px; font-weight:600; color:#64748b;">
            <span id="lbl-qnum">Question <span id="q-num">1</span></span>
            <span id="timer-box" style="color:#ef4444; display:none;">‚è±Ô∏è <span id="time-left">90:00</span></span>
        </div>

        <h2 id="q-text" style="font-size:20px; margin-bottom:25px; line-height:1.4;">Question?</h2>
        
        <div id="opts">
            </div>
        
        <div id="feedback" style="height:30px; margin-top:15px; text-align:center;"></div>
    </div>

    <div id="screen-result" class="screen">
        <div class="result-box">
            <div class="score-circle" id="final-score">0</div>
            <h2 id="score-text">You Scored</h2>
            <p id="result-msg" style="font-size:18px; margin-bottom:30px;"></p>
            
            <button class="action-btn" onclick="showReview()" id="lbl-review" style="background:#fff; color:#333; border:1px solid #ddd; margin-bottom:10px;">Review Answers</button>
            <button class="action-btn" onclick="shareScore()" id="lbl-share">Share Score</button>
            <button class="action-btn" onclick="goToMenu()" id="lbl-menu" style="background:transparent; color:#64748b; margin-top:5px;">Back to Menu</button>
        </div>
    </div>

    <div id="screen-review" class="screen">
        <h3 style="margin-bottom:20px;">Review Answers</h3>
        <div id="review-list"></div>
        <button class="action-btn" onclick="closeReview()">Close</button>
    </div>

</div>

<script>
    // 1. LANGUAGE SETUP
    const urlParams = new URLSearchParams(window.location.search);
    const lang = urlParams.get('lang') || 'en';

    const ui = {
        en: { home: "‚Üê Home", title: "Railway Group D", select: "Select Mode:", prac: "Practice Quiz", pracSub: "5 Random Questions", test: "Test Mode", testSub: "100 Questions ‚Ä¢ 90 Mins", qNum: "Question", review: "Review Answers", share: "Share Score", menu: "Main Menu" },
        hi: { home: "‚Üê ‡§ò‡§∞", title: "‡§∞‡•á‡§≤‡§µ‡•á ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§°‡•Ä", select: "‡§Æ‡•ã‡§° ‡§ö‡•Å‡§®‡•á‡§Ç:", prac: "‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º", pracSub: "5 ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§®", test: "‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•ã‡§°", testSub: "100 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‚Ä¢ 90 ‡§Æ‡§ø‡§®‡§ü", qNum: "‡§™‡•ç‡§∞‡§∂‡•ç‡§®", review: "‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§ñ‡•á‡§Ç", share: "‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç", menu: "‡§Æ‡•á‡§®‡•Ç" },
        mr: { home: "‚Üê ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§™‡•É‡§∑‡•ç‡§†", title: "‡§∞‡•á‡§≤‡•ç‡§µ‡•á ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§°‡•Ä", select: "‡§Æ‡•ã‡§° ‡§®‡§ø‡§µ‡§°‡§æ:", prac: "‡§∏‡§∞‡§æ‡§µ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡§Æ‡§Ç‡§ú‡•Å‡§∑‡§æ", pracSub: "5 ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§®", test: "‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•ã‡§°", testSub: "100 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‚Ä¢ 90 ‡§Æ‡§ø‡§®‡§ø‡§ü‡•á", qNum: "‡§™‡•ç‡§∞‡§∂‡•ç‡§®", review: "‡§â‡§§‡•ç‡§§‡§∞‡•á ‡§§‡§™‡§æ‡§∏‡§æ", share: "‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§∂‡•á‡§Ö‡§∞ ‡§ï‡§∞‡§æ", menu: "‡§Æ‡•á‡§®‡•Ç" },
        bn: { home: "‚Üê ‡¶¨‡¶æ‡¶°‡¶º‡¶ø", title: "‡¶∞‡ßá‡¶≤‡¶ì‡¶Ø‡¶º‡ßá ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶°‡¶ø", select: "‡¶Æ‡ßã‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:", prac: "‡¶Ö‡¶®‡ßÅ‡¶∂‡ßÄ‡¶≤‡¶® ‡¶ï‡ßÅ‡¶á‡¶ú", pracSub: "‡ß´‡¶ü‡¶ø ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®", test: "‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶Æ‡ßã‡¶°", testSub: "‡ßß‡ß¶‡ß¶‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‚Ä¢ ‡ßØ‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü", qNum: "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®", review: "‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®", share: "‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®", menu: "‡¶Æ‡ßá‡¶®‡ßÅ" },
        ta: { home: "‚Üê ‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ", title: "‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç‡Æµ‡Øá ‡Æï‡ØÅ‡Æ∞‡ØÇ‡Æ™‡Øç ‡Æü‡Æø", select: "‡ÆÆ‡ØÅ‡Æ±‡Øà‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç:", prac: "‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø ‡Æµ‡Æø‡Æ©‡Ææ‡Æü‡Æø ‡Æµ‡Æø‡Æ©‡Ææ", pracSub: "5 ‡Æö‡ØÄ‡Æ∞‡Æ±‡Øç‡Æ± ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡Æï‡Æ≥‡Øç", test: "‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ ‡ÆÆ‡ØÅ‡Æ±‡Øà", testSub: "100 ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡Æï‡Æ≥‡Øç ‚Ä¢ 90 ‡Æ®‡Æø‡ÆÆ‡Æø‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øç", qNum: "‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø", review: "‡Æ™‡Æ§‡Æø‡Æ≤‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", share: "‡Æ™‡Æï‡Æø‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç", menu: "‡ÆÆ‡ØÜ‡Æ©‡ØÅ" },
        te: { home: "‚Üê ‡∞π‡±ã‡∞Æ‡±ç", title: "‡∞∞‡±à‡∞≤‡±ç‡∞µ‡±á ‡∞ó‡±ç‡∞∞‡±Ç‡∞™‡±ç D", select: "‡∞Æ‡±ã‡∞°‡±ç‚Äå‡∞®‡∞ø ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø:", prac: "‡∞™‡±ç‡∞∞‡∞æ‡∞ï‡±ç‡∞ü‡±Ä‡∞∏‡±ç ‡∞ï‡±ç‡∞µ‡∞ø‡∞ú‡±ç", pracSub: "5 ‡∞Ø‡∞æ‡∞¶‡±É‡∞ö‡±ç‡∞õ‡∞ø‡∞ï ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞≤‡±Å", test: "‡∞™‡∞∞‡±Ä‡∞ï‡±ç‡∞∑ ‡∞Æ‡±ã‡∞°‡±ç", testSub: "100 ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞≤‡±Å ‚Ä¢ 90 ‡∞®‡∞ø‡∞Æ‡∞ø‡∞∑‡∞æ‡∞≤‡±Å", qNum: "‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®", review: "‡∞∏‡∞Æ‡∞æ‡∞ß‡∞æ‡∞®‡∞æ‡∞≤‡±Å", share: "‡∞∑‡±á‡∞∞‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø", menu: "‡∞Æ‡±Ü‡∞®‡±Å" }
    };

    // Apply Translations
    const t = ui[lang] || ui['en'];
    
    document.getElementById('lbl-home').innerText = t.home;
    document.getElementById('lbl-title').innerText = t.title;
    document.getElementById('lbl-select').innerText = t.select;
    document.getElementById('lbl-prac').innerText = t.prac;
    document.getElementById('lbl-prac-sub').innerText = t.pracSub;
    document.getElementById('lbl-test').innerText = t.test;
    document.getElementById('lbl-test-sub').innerText = t.testSub;
    document.getElementById('lbl-qnum').firstChild.nodeValue = t.qNum + " ";
    document.getElementById('lbl-review').innerText = t.review;
    document.getElementById('lbl-share').innerText = t.share;
    document.getElementById('lbl-menu').innerText = t.menu;

    // 2. GAME VARIABLES
    let currentSessionQuestions = [];
    let currentQIndex = 0;
    let score = 0;
    let userAnswers = [];
    let timerInterval;

    // 3. START FUNCTIONS
    function startPractice() {
        if (typeof masterDB === 'undefined') { alert("Data file not found. Check 'railwaydquestions.js'"); return; }
        let allQs = masterDB.railway[lang] || masterDB.railway['en'];
        let shuffled = [...allQs].sort(() => 0.5 - Math.random());
        currentSessionQuestions = shuffled.slice(0, 5);
        startQuiz();
    }

    function startExam() {
        if (typeof masterDB === 'undefined') { alert("Data file not found."); return; }
        let allQs = masterDB.railway[lang] || masterDB.railway['en'];
        currentSessionQuestions = [...allQs].sort(() => 0.5 - Math.random()).slice(0, 100);
        startQuiz(true);
    }

    function startQuiz(isExam = false) {
        currentQIndex = 0;
        score = 0;
        userAnswers = [];
        
        document.getElementById('screen-modes').classList.remove('active');
        document.getElementById('screen-quiz').classList.add('active');
        
        loadQuestion();
        
        if (isExam) {
            document.getElementById('timer-box').style.display = "inline";
            startTimer(90 * 60);
        } else {
            document.getElementById('timer-box').style.display = "none";
        }
    }

    function loadQuestion() {
        let q = currentSessionQuestions[currentQIndex];
        document.getElementById('q-num').innerText = currentQIndex + 1;
        document.getElementById('q-text').innerText = q.q;
        
        let optsDiv = document.getElementById('opts');
        optsDiv.innerHTML = "";
        document.getElementById('feedback').innerHTML = "";
        
        let btnArray = [];
        q.o.forEach((optText, idx) => {
            let btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = optText;
            btn.onclick = () => checkAnswer(idx, q.a, btn, btnArray, q);
            optsDiv.appendChild(btn);
            btnArray.push(btn);
        });
    }

    function checkAnswer(selectedIdx, correctIdx, btn, btnArray, qData) {
        btnArray.forEach(b => b.disabled = true);
        
        let isCorrect = (selectedIdx === correctIdx);
        if (isCorrect) score++;
        
        userAnswers.push({ q: qData.q, opts: qData.o, sel: selectedIdx, cor: correctIdx });

        if (isCorrect) {
            btn.classList.add('correct');
        } else {
            btn.classList.add('wrong');
            btnArray[correctIdx].classList.add('correct');
        }

        setTimeout(() => {
            if (currentQIndex < currentSessionQuestions.length - 1) {
                currentQIndex++;
                loadQuestion();
            } else {
                showResults();
            }
        }, 1500);
    }

    function showResults() {
        clearInterval(timerInterval);
        document.getElementById('screen-quiz').classList.remove('active');
        document.getElementById('screen-result').classList.add('active');
        
        let percentage = (score / currentSessionQuestions.length) * 100;
        document.getElementById('final-score').innerText = score;
        document.getElementById('score-text').innerText = `You Scored ${score} / ${currentSessionQuestions.length}`;
        
        let msg = document.getElementById('result-msg');
        if (percentage >= 35) {
            msg.innerText = "üéâ Congratulations! You Passed!";
            msg.style.color = "green";
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        } else {
            msg.innerText = "‚ö†Ô∏è Needs Improvement. Keep Studying!";
            msg.style.color = "#dc2626";
        }
    }

    function showReview() {
        document.getElementById('screen-result').classList.remove('active');
        document.getElementById('screen-review').classList.add('active');
        let list = document.getElementById('review-list');
        list.innerHTML = "";
        userAnswers.forEach((item, index) => {
            let div = document.createElement('div');
            div.style.marginBottom = "15px";
            div.style.borderBottom = "1px solid #eee";
            div.style.paddingBottom = "10px";
            
            let status = (item.sel === item.cor) ? "‚úÖ" : "‚ùå";
            let correctAns = item.opts[item.cor];
            let userAns = item.opts[item.sel];
            
            div.innerHTML = `
                <div style="font-weight:600; font-size:14px;">${index+1}. ${item.q}</div>
                <div style="font-size:13px; color:#555; margin-top:4px;">
                    Your Ans: <b>${userAns}</b> ${status} <br>
                    ${item.sel !== item.cor ? `<span style="color:green">Correct: ${correctAns}</span>` : ''}
                </div>
            `;
            list.appendChild(div);
        });
    }

    function closeReview() {
        document.getElementById('screen-review').classList.remove('active');
        document.getElementById('screen-result').classList.add('active');
    }

    function shareScore() {
        let text = `üî• I just scored ${score}/${currentSessionQuestions.length} in Railway Group D practice on Hunar App!`;
        window.open("https://wa.me/?text=" + encodeURIComponent(text), "_blank");
    }

    function goToMenu() {
        window.location.reload();
    }

    function startTimer(duration) {
        let timer = duration, m, s;
        timerInterval = setInterval(() => {
            m = parseInt(timer / 60, 10);
            s = parseInt(timer % 60, 10);
            m = m < 10 ? "0" + m : m;
            s = s < 10 ? "0" + s : s;
            document.getElementById('time-left').textContent = m + ":" + s;
            if (--timer < 0) {
                clearInterval(timerInterval);
                showResults();
            }
        }, 1000);
    }
</script>

</body>
</html>
