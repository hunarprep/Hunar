<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITI Electrician - Premium</title>
    
    <script src="itiquestions.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #059669; --primary-dark: #047857; --primary-soft: #ecfdf5;
            --bg-body: #f3f4f6; --surface: #ffffff; --text-main: #111827;
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-body); margin: 0; display: flex; justify-content: center; }
        .app-container { width: 100%; max-width: 480px; background: var(--surface); min-height: 100vh; display: flex; flex-direction: column; box-shadow: 0 0 25px rgba(0,0,0,0.05); }

        /* HEADER */
        .header {
            background: linear-gradient(180deg, var(--primary-dark), var(--primary));
            color: white; padding: 30px 25px 40px;
            border-bottom-left-radius: 32px; border-bottom-right-radius: 32px;
        }
        .header-nav a {
            background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px;
            text-decoration: none; color: white; font-size: 13px; font-weight: 600;
            backdrop-filter: blur(4px);
        }
        .header h1 { margin: 20px 0 5px; font-size: 28px; }

        /* CONTENT */
        .content { padding: 30px; flex-grow: 1; }
        .screen { display: none; animation: fadeIn 0.3s ease-out; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; } }

        /* CARDS */
        .menu-card {
            background: white; border: 1px solid #e5e7eb; border-radius: 20px; padding: 20px;
            margin-bottom: 16px; display: flex; align-items: center; cursor: pointer;
            box-shadow: var(--shadow-card); transition: transform 0.2s;
        }
        .menu-card:active { transform: scale(0.98); background: var(--primary-soft); }

        /* QUIZ UI */
        .opt-btn {
            width: 100%; padding: 18px; margin-bottom: 12px; border: 1px solid #e5e7eb;
            background: white; border-radius: 16px; font-size: 16px; text-align: left;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02); color: var(--text-main);
        }
        .opt-btn.correct { background: #dcfce7; border-color: #22c55e; color: #14532d; }
        .opt-btn.wrong { background: #fee2e2; border-color: #ef4444; color: #7f1d1d; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <div class="header-nav"><a href="index.html" id="lbl-home">‚Üê Home</a></div>
        <h1 id="lbl-title">ITI Electrician</h1>
        <p>Theory & Safety</p>
    </div>

    <div class="content">
        <div id="screen-modes" class="screen active">
            <h3 id="lbl-select" style="color:#6b7280; margin-bottom:20px; text-transform:uppercase; font-size:13px; letter-spacing:1px;">Select Mode</h3>
            
            <div class="menu-card" onclick="startPractice()">
                <div style="font-size:28px; margin-right:15px;">‚ö°</div>
                <div><strong id="lbl-prac">Practice Quiz</strong><br><span id="lbl-prac-sub" style="font-size:13px; color:#6b7280;">5 Random Questions</span></div>
            </div>

            <div class="menu-card" onclick="startExam()">
                <div style="font-size:28px; margin-right:15px;">‚è±Ô∏è</div>
                <div><strong id="lbl-test">Test Mode</strong><br><span id="lbl-test-sub" style="font-size:13px; color:#6b7280;">100 Questions ‚Ä¢ 90 Mins</span></div>
            </div>
        </div>

        <div id="screen-quiz" class="screen">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px; color:#6b7280; font-weight:600;">
                <span id="lbl-qnum">Question <span id="q-num">1</span></span>
                <span id="timer-box" style="color:#ef4444; display:none;">‚è±Ô∏è <span id="time-left">90:00</span></span>
            </div>
            <h2 id="q-text" style="font-size:19px; line-height:1.5; margin-bottom:25px;">Loading...</h2>
            <div id="opts"></div>
        </div>

        <div id="screen-result" class="screen" style="text-align:center;">
            <div style="font-size:60px; margin-bottom:10px;">üèÜ</div>
            <h2 id="score-text" style="margin-bottom:5px;">Score: 0</h2>
            <p id="result-msg" style="color:#6b7280; margin-bottom:30px;">Keep Learning!</p>
            <button class="opt-btn" onclick="location.reload()" style="text-align:center; background:var(--primary); color:white; font-weight:bold;">Back to Menu</button>
        </div>
    </div>
</div>

<script>
    // 1. SETUP
    const urlParams = new URLSearchParams(window.location.search);
    const lang = urlParams.get('lang') || 'en';
    
    // 2. TEXT DATA
    const ui = {
        en: { home:"‚Üê Home", title:"ITI Electrician", select:"Select Mode", prac:"Practice Quiz", pracSub:"5 Random Questions", test:"Test Mode", testSub:"100 Qs ‚Ä¢ 90 Mins", qNum:"Question" },
        hi: { home:"‚Üê ‡§ò‡§∞", title:"ITI ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•Ä‡§∂‡§ø‡§Ø‡§®", select:"‡§Æ‡•ã‡§° ‡§ö‡•Å‡§®‡•á‡§Ç", prac:"‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º", pracSub:"5 ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§®", test:"‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•ã‡§°", testSub:"100 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‚Ä¢ 90 ‡§Æ‡§ø‡§®‡§ü", qNum:"‡§™‡•ç‡§∞‡§∂‡•ç‡§®" },
        mr: { home:"‚Üê ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§™‡•É‡§∑‡•ç‡§†", title:"ITI ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§ø‡§∂‡§ø‡§Ø‡§®", select:"‡§Æ‡•ã‡§° ‡§®‡§ø‡§µ‡§°‡§æ", prac:"‡§∏‡§∞‡§æ‡§µ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡§Æ‡§Ç‡§ú‡•Å‡§∑‡§æ", pracSub:"5 ‡§™‡•ç‡§∞‡§∂‡•ç‡§®", test:"‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•ã‡§°", testSub:"100 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‚Ä¢ 90 ‡§Æ‡§ø‡§®‡§ø‡§ü‡•á", qNum:"‡§™‡•ç‡§∞‡§∂‡•ç‡§®" },
        bn: { home:"‚Üê ‡¶¨‡¶æ‡¶°‡¶º‡¶ø", title:"ITI ‡¶á‡¶≤‡ßá‡¶ï‡¶ü‡ßç‡¶∞‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶®", select:"‡¶Æ‡ßã‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®", prac:"‡¶Ö‡¶®‡ßÅ‡¶∂‡ßÄ‡¶≤‡¶® ‡¶ï‡ßÅ‡¶á‡¶ú", pracSub:"‡ß´‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®", test:"‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶Æ‡ßã‡¶°", testSub:"‡ßß‡ß¶‡ß¶‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‚Ä¢ ‡ßØ‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü", qNum:"‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®" },
        ta: { home:"‚Üê ‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ", title:"‡Æê‡Æü‡Æø‡Æê ‡Æé‡Æ≤‡Æï‡Øç‡Æü‡Øç‡Æ∞‡ØÄ‡Æö‡Æø‡ÆØ‡Æ©‡Øç", select:"‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ", prac:"‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø", pracSub:"5 ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡Æï‡Æ≥‡Øç", test:"‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ", testSub:"100 ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡Æï‡Æ≥‡Øç", qNum:"‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø" },
        te: { home:"‚Üê ‡∞π‡±ã‡∞Æ‡±ç", title:"ITI ‡∞é‡∞≤‡∞ï‡±ç‡∞ü‡±ç‡∞∞‡±Ä‡∞∑‡∞ø‡∞Ø‡∞®‡±ç", select:"‡∞Æ‡±ã‡∞°‡±ç ‡∞é‡∞Ç‡∞™‡∞ø‡∞ï", prac:"‡∞™‡±ç‡∞∞‡∞æ‡∞ï‡±ç‡∞ü‡±Ä‡∞∏‡±ç", pracSub:"5 ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞≤‡±Å", test:"‡∞™‡∞∞‡±Ä‡∞ï‡±ç‡∞∑", testSub:"100 ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞≤‡±Å", qNum:"‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®" }
    };

    // 3. APPLY TEXT & CHECK DB
    window.onload = function() {
        if(typeof masterDB === 'undefined') {
            alert("‚ö†Ô∏è Error: 'itiquestions.js' not found.\nPlease rename 'itiquestions (1).js' to 'itiquestions.js'");
        }
        const t = ui[lang] || ui['en'];
        document.getElementById('lbl-home').innerText = t.home;
        document.getElementById('lbl-title').innerText = t.title;
        document.getElementById('lbl-select').innerText = t.select;
        document.getElementById('lbl-prac').innerText = t.prac;
        document.getElementById('lbl-prac-sub').innerText = t.pracSub;
        document.getElementById('lbl-test').innerText = t.test;
        document.getElementById('lbl-test-sub').innerText = t.testSub;
        document.getElementById('lbl-qnum').firstChild.nodeValue = t.qNum + " ";
    };

    // 4. GAME LOGIC
    let questions = [], index = 0, score = 0, timer;

    function startPractice() {
        if(typeof masterDB === 'undefined') return alert("Database Missing!");
        let all = masterDB.iti[lang] || masterDB.iti['en'];
        questions = [...all].sort(()=>0.5-Math.random()).slice(0, 5);
        startQuiz(false);
    }

    function startExam() {
        if(typeof masterDB === 'undefined') return alert("Database Missing!");
        let all = masterDB.iti[lang] || masterDB.iti['en'];
        questions = [...all].sort(()=>0.5-Math.random()).slice(0, 100);
        startQuiz(true);
    }

    function startQuiz(isExam) {
        index = 0; score = 0;
        document.getElementById('screen-modes').classList.remove('active');
        document.getElementById('screen-quiz').classList.add('active');
        document.getElementById('timer-box').style.display = isExam ? "inline" : "none";
        loadQ();
        if(isExam) startTimer(90*60);
    }

    function loadQ() {
        let q = questions[index];
        document.getElementById('q-num').innerText = index + 1;
        document.getElementById('q-text').innerText = q.q;
        let div = document.getElementById('opts');
        div.innerHTML = "";
        q.o.forEach((opt, i) => {
            let btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = opt;
            btn.onclick = () => check(i, q.a, btn, q.o.length);
            div.appendChild(btn);
        });
    }

    function check(sel, cor, btn, count) {
        let btns = document.getElementsByClassName('opt-btn');
        for(let b of btns) b.disabled = true;
        
        if(sel === cor) { score++; btn.classList.add('correct'); }
        else { btn.classList.add('wrong'); btns[cor].classList.add('correct'); }

        setTimeout(() => {
            if(index < questions.length - 1) { index++; loadQ(); }
            else endQuiz();
        }, 1000);
    }

    function endQuiz() {
        clearInterval(timer);
        document.getElementById('screen-quiz').classList.remove('active');
        document.getElementById('screen-result').classList.add('active');
        document.getElementById('score-text').innerText = `Score: ${score} / ${questions.length}`;
        if(score/questions.length >= 0.35) confetti();
    }

    function startTimer(sec) {
        timer = setInterval(() => {
            let m = Math.floor(sec/60), s = sec%60;
            document.getElementById('time-left').innerText = `${m}:${s<10?'0'+s:s}`;
            if(--sec < 0) endQuiz();
        }, 1000);
    }
</script>
</body>
</html>
